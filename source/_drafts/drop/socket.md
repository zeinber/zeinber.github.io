---
title: 浅析 Socket
date: 2016-05-20 17:00:01
tags:
    - Socket
categories: 网络
---

目前网络上大部分应用程序的通信都是 socket 实现的，在解释什么是 socket 之前，要先了解什么是网络进程通信原理。

<!--more-->

## 网络进程通信原理

我们知道，在同一台机器上，进程间可以很容易地进行通信。

网络进程通信是不同主机进程间的相互通信，那么只要让一台主机能在网络中定位到另一台主机，并与其建立连接，那么两台主机就能进行通信了。
 TCP／IP 协议族已经解决了这个问题，网络层的 IP 地址可以唯一标识网络中的主机，而传输层的“协议+端口”可以唯一标识主机中的应用程序（进程）。利用（ ip 地址，协议，端口）就可以标识网络中另一台主机的进程，网络中的进程通信就是利用这个标识与其它进程进行交互。

socket 起源于 Unix ，而 Unix/Linux 基本哲学之一就是“一切皆文件”，都可以用
```
打开 open –> 读写 write/read –> 关闭 close
```
模式来操作。        
Socket 是应用层与 TCP/IP 协议族通信的中间软件抽象层，它是一组接口。在设计模式中， Socket 其实就是一个门面模式，它把复杂的 TCP/IP 协议族隐藏在 Socket 接口后面，对用户来说，一组简单的接口就是全部，让 Socket 去组织数据，以符合指定的协议。

## 具体流程

![socket 交互过程](http://upload-images.jianshu.io/upload_images/3983945-ac6cff602f62120d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

服务器端先初始化 Socket ，然后与端口绑定 (bind) ，对端口进行监听 (listen) ，调用 accept 阻塞，等待客户端连接。在这时如果有个客户端初始化一个 Socket ，然后连接服务器 (connect) ，如果连接成功，这时客户端与服务器端的连接就建立了。客户端发送数据请求，服务器端接收请求并处理请求，然后把回应数据发送给客户端，客户端读取数据，最后关闭连接，一次交互结束。
